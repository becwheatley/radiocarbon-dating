labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Singleton recent
sre <- ggplot(NULL) +
geom_ribbon(aes(x = spd.singleton.recent$baseline$calBP, ymin = spd.singleton.recent$envelope[[1]][,1],
ymax = spd.singleton.recent$envelope[[1]][,3]), fill = "#8DA0CB", alpha = 0.3) +
geom_line(aes(x = spd.singleton.recent$baseline$calBP, y = spd.singleton.recent$envelope[[1]][,2]), lwd = 1, color = "#8DA0CB") +
geom_line(aes(x = spd.singleton.recent$baseline$calBP, y = spd.singleton.recent$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Singleton random
sra <- ggplot(NULL) +
geom_ribbon(aes(x = spd.singleton.random$baseline$calBP, ymin = spd.singleton.random$envelope[[1]][,1],
ymax = spd.singleton.random$envelope[[1]][,3]), fill = "#E78AC3", alpha = 0.3) +
geom_line(aes(x = spd.singleton.random$baseline$calBP, y = spd.singleton.random$envelope[[1]][,2]), lwd = 1, color = "#E78AC3") +
geom_line(aes(x = spd.singleton.random$baseline$calBP, y = spd.singleton.random$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Bracketed
b <- ggplot(NULL) +
geom_ribbon(aes(x = spd.bracketed$baseline$calBP, ymin = spd.bracketed$envelope[[1]][,1],
ymax = spd.bracketed$envelope[[1]][,3]), fill = "#A6D854", alpha = 0.3) +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$envelope[[1]][,2]), lwd = 1, color = "#A6D854") +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Multi-panelled plot
ggarrange(u, sre, san, sra, b,
labels = c("Uniform", "Singleton recent", "Singleton ancient", "Singelton random", "Bracketed"),
ncol = 3, nrow = 2)
# Combined
ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_ribbon(aes(x = spd.singleton.ancient$baseline$calBP, ymin = spd.singleton.ancient$envelope[[1]][,1],
ymax = spd.singleton.ancient$envelope[[1]][,3]), fill = "#FC8D62", alpha = 0.3) +
geom_ribbon(aes(x = spd.singleton.recent$baseline$calBP, ymin = spd.singleton.recent$envelope[[1]][,1],
ymax = spd.singleton.recent$envelope[[1]][,3]), fill = "#8DA0CB", alpha = 0.3) +
geom_ribbon(aes(x = spd.singleton.random$baseline$calBP, ymin = spd.singleton.random$envelope[[1]][,1],
ymax = spd.singleton.random$envelope[[1]][,3]), fill = "#E78AC3", alpha = 0.3) +
geom_ribbon(aes(x = spd.bracketed$baseline$calBP, ymin = spd.bracketed$envelope[[1]][,1],
ymax = spd.bracketed$envelope[[1]][,3]), fill = "#A6D854", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.singleton.ancient$baseline$calBP, y = spd.singleton.ancient$envelope[[1]][,2]), lwd = 1, color = "#FC8D62") +
geom_line(aes(x = spd.singleton.recent$baseline$calBP, y = spd.singleton.recent$envelope[[1]][,2]), lwd = 1, color = "#8DA0CB") +
geom_line(aes(x = spd.singleton.random$baseline$calBP, y = spd.singleton.random$envelope[[1]][,2]), lwd = 1, color = "#E78AC3") +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$envelope[[1]][,2]), lwd = 1, color = "#A6D854") +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
ggtitle("All subsets combined") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Singleton ancient
san <- ggplot(NULL) +
geom_ribbon(aes(x = spd.singleton.ancient$baseline$calBP, ymin = spd.singleton.ancient$envelope[[1]][,1],
ymax = spd.singleton.ancient$envelope[[1]][,3]), fill = "#FC8D62", alpha = 0.3) +
geom_line(aes(x = spd.singleton.ancient$baseline$calBP, y = spd.singleton.ancient$envelope[[1]][,2]), lwd = 1,
color = "#FC8D62") +
geom_line(aes(x = spd.singleton.ancient$baseline$calBP, y = spd.singleton.ancient$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Singleton recent
sre <- ggplot(NULL) +
geom_ribbon(aes(x = spd.singleton.recent$baseline$calBP, ymin = spd.singleton.recent$envelope[[1]][,1],
ymax = spd.singleton.recent$envelope[[1]][,3]), fill = "#8DA0CB", alpha = 0.3) +
geom_line(aes(x = spd.singleton.recent$baseline$calBP, y = spd.singleton.recent$envelope[[1]][,2]), lwd = 1, color = "#8DA0CB") +
geom_line(aes(x = spd.singleton.recent$baseline$calBP, y = spd.singleton.recent$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Singleton random
sra <- ggplot(NULL) +
geom_ribbon(aes(x = spd.singleton.random$baseline$calBP, ymin = spd.singleton.random$envelope[[1]][,1],
ymax = spd.singleton.random$envelope[[1]][,3]), fill = "#E78AC3", alpha = 0.3) +
geom_line(aes(x = spd.singleton.random$baseline$calBP, y = spd.singleton.random$envelope[[1]][,2]), lwd = 1, color = "#E78AC3") +
geom_line(aes(x = spd.singleton.random$baseline$calBP, y = spd.singleton.random$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Bracketed
b <- ggplot(NULL) +
geom_ribbon(aes(x = spd.bracketed$baseline$calBP, ymin = spd.bracketed$envelope[[1]][,1],
ymax = spd.bracketed$envelope[[1]][,3]), fill = "#A6D854", alpha = 0.3) +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$envelope[[1]][,2]), lwd = 1, color = "#A6D854") +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(limits=timeRange) +
theme_bw()
# Multi-panelled plot
ggarrange(u, sre, san, sra, b,
labels = c("Uniform", "Singleton recent", "Singleton ancient", "Singelton random", "Bracketed"),
ncol = 3, nrow = 2)
# Combined
ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_ribbon(aes(x = spd.singleton.ancient$baseline$calBP, ymin = spd.singleton.ancient$envelope[[1]][,1],
ymax = spd.singleton.ancient$envelope[[1]][,3]), fill = "#FC8D62", alpha = 0.3) +
geom_ribbon(aes(x = spd.singleton.recent$baseline$calBP, ymin = spd.singleton.recent$envelope[[1]][,1],
ymax = spd.singleton.recent$envelope[[1]][,3]), fill = "#8DA0CB", alpha = 0.3) +
geom_ribbon(aes(x = spd.singleton.random$baseline$calBP, ymin = spd.singleton.random$envelope[[1]][,1],
ymax = spd.singleton.random$envelope[[1]][,3]), fill = "#E78AC3", alpha = 0.3) +
geom_ribbon(aes(x = spd.bracketed$baseline$calBP, ymin = spd.bracketed$envelope[[1]][,1],
ymax = spd.bracketed$envelope[[1]][,3]), fill = "#A6D854", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.singleton.ancient$baseline$calBP, y = spd.singleton.ancient$envelope[[1]][,2]), lwd = 1, color = "#FC8D62") +
geom_line(aes(x = spd.singleton.recent$baseline$calBP, y = spd.singleton.recent$envelope[[1]][,2]), lwd = 1, color = "#8DA0CB") +
geom_line(aes(x = spd.singleton.random$baseline$calBP, y = spd.singleton.random$envelope[[1]][,2]), lwd = 1, color = "#E78AC3") +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$envelope[[1]][,2]), lwd = 1, color = "#A6D854") +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
ggtitle("All subsets combined") +
scale_x_reverse(limits=timeRange) +
theme_bw()
12000-200
11800/500
11800/600
11800/700
11800/800
11800/900
12200-200
12000/6000
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_continuous(breaks=breaks = seq(200, 12200, by = 600), limits = c(200, 12200))+
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_continuous(breaks = seq(200, 12200, by = 600), limits = c(200, 12200))+
scale_x_reverse(limits=timeRange) +
theme_bw()
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(200, 12200, by = 600), limits = c(200, 12200))+
#scale_x_reverse(limits=timeRange) +
theme_bw()
u
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(12200, 200, by = 600), limits = c(12200, 200))+
#scale_x_reverse(limits=timeRange) +
theme_bw()
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_continuous(breaks = seq(200, 12200, by = 600), limits = c(200, 12200))+
#scale_x_reverse(limits=timeRange) +
theme_bw()
u
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(200, 12200, by = 600), limits = c(200, 12200))+
#scale_x_reverse(limits=timeRange) +
theme_bw()
u
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(12200, 200, by = 600), limits = c(12200, 200))+
#scale_x_reverse(limits=timeRange) +
theme_bw()
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(12200, 200, by = -600), limits = c(12200, 200))+
#scale_x_reverse(limits=timeRange) +
theme_bw()
u
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(12200, 200, by = -6000), limits = c(12200, 200))+
#scale_x_reverse(limits=timeRange) +
theme_bw()
u
# Uniform
u <- ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(12200, 200, by = -6000), limits = c(12200, 200)) +
theme_bw()
# Singleton ancient
san <- ggplot(NULL) +
geom_ribbon(aes(x = spd.singleton.ancient$baseline$calBP, ymin = spd.singleton.ancient$envelope[[1]][,1],
ymax = spd.singleton.ancient$envelope[[1]][,3]), fill = "#FC8D62", alpha = 0.3) +
geom_line(aes(x = spd.singleton.ancient$baseline$calBP, y = spd.singleton.ancient$envelope[[1]][,2]), lwd = 1,
color = "#FC8D62") +
geom_line(aes(x = spd.singleton.ancient$baseline$calBP, y = spd.singleton.ancient$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(12200, 200, by = -6000), limits = c(12200, 200)) +
theme_bw()
# Singleton recent
sre <- ggplot(NULL) +
geom_ribbon(aes(x = spd.singleton.recent$baseline$calBP, ymin = spd.singleton.recent$envelope[[1]][,1],
ymax = spd.singleton.recent$envelope[[1]][,3]), fill = "#8DA0CB", alpha = 0.3) +
geom_line(aes(x = spd.singleton.recent$baseline$calBP, y = spd.singleton.recent$envelope[[1]][,2]), lwd = 1, color = "#8DA0CB") +
geom_line(aes(x = spd.singleton.recent$baseline$calBP, y = spd.singleton.recent$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(12200, 200, by = -6000), limits = c(12200, 200)) +
theme_bw()
# Singleton random
sra <- ggplot(NULL) +
geom_ribbon(aes(x = spd.singleton.random$baseline$calBP, ymin = spd.singleton.random$envelope[[1]][,1],
ymax = spd.singleton.random$envelope[[1]][,3]), fill = "#E78AC3", alpha = 0.3) +
geom_line(aes(x = spd.singleton.random$baseline$calBP, y = spd.singleton.random$envelope[[1]][,2]), lwd = 1, color = "#E78AC3") +
geom_line(aes(x = spd.singleton.random$baseline$calBP, y = spd.singleton.random$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(12200, 200, by = -6000), limits = c(12200, 200)) +
theme_bw()
# Bracketed
b <- ggplot(NULL) +
geom_ribbon(aes(x = spd.bracketed$baseline$calBP, ymin = spd.bracketed$envelope[[1]][,1],
ymax = spd.bracketed$envelope[[1]][,3]), fill = "#A6D854", alpha = 0.3) +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$envelope[[1]][,2]), lwd = 1, color = "#A6D854") +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
scale_x_reverse(breaks = seq(12200, 200, by = -6000), limits = c(12200, 200)) +
theme_bw()
# Multi-panelled plot
ggarrange(u, sre, san, sra, b,
labels = c("Uniform", "Singleton recent", "Singleton ancient", "Singelton random", "Bracketed"),
ncol = 2, nrow = 3)
# Combined
ggplot(NULL) +
geom_ribbon(aes(x = spd.uniform$baseline$calBP, ymin = spd.uniform$envelope[[1]][,1],
ymax = spd.uniform$envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_ribbon(aes(x = spd.singleton.ancient$baseline$calBP, ymin = spd.singleton.ancient$envelope[[1]][,1],
ymax = spd.singleton.ancient$envelope[[1]][,3]), fill = "#FC8D62", alpha = 0.3) +
geom_ribbon(aes(x = spd.singleton.recent$baseline$calBP, ymin = spd.singleton.recent$envelope[[1]][,1],
ymax = spd.singleton.recent$envelope[[1]][,3]), fill = "#8DA0CB", alpha = 0.3) +
geom_ribbon(aes(x = spd.singleton.random$baseline$calBP, ymin = spd.singleton.random$envelope[[1]][,1],
ymax = spd.singleton.random$envelope[[1]][,3]), fill = "#E78AC3", alpha = 0.3) +
geom_ribbon(aes(x = spd.bracketed$baseline$calBP, ymin = spd.bracketed$envelope[[1]][,1],
ymax = spd.bracketed$envelope[[1]][,3]), fill = "#A6D854", alpha = 0.3) +
geom_line(aes(x = spd.uniform$baseline$calBP, y = spd.uniform$envelope[[1]][,2]), lwd = 1, color = "#66C2A5") +
geom_line(aes(x = spd.singleton.ancient$baseline$calBP, y = spd.singleton.ancient$envelope[[1]][,2]), lwd = 1, color = "#FC8D62") +
geom_line(aes(x = spd.singleton.recent$baseline$calBP, y = spd.singleton.recent$envelope[[1]][,2]), lwd = 1, color = "#8DA0CB") +
geom_line(aes(x = spd.singleton.random$baseline$calBP, y = spd.singleton.random$envelope[[1]][,2]), lwd = 1, color = "#E78AC3") +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$envelope[[1]][,2]), lwd = 1, color = "#A6D854") +
geom_line(aes(x = spd.bracketed$baseline$calBP, y = spd.bracketed$baseline$PrDens), lwd = 1, colour = "black",
linetype = "dashed") +
labs(x = "Years cal BP", y = "Probability") +
ggtitle("All subsets combined") +
scale_x_reverse(breaks = seq(12200, 200, by = -6000), limits = c(12200, 200)) +
theme_bw()
taphCorrect = TRUE    ## whether to taphonomically correct the open sites - not currently as haven't specified whether sites are open
correctForSite = FALSE ## per bin: number of sites with at least one date in them, or number of dates within the bin total
binSize = 100          ## the size of the bins to use (years) - use a bin size that actually fits the timeRange specified
fd.uniform           <- compare_frequency_dists(evidence = baseline.data,
samples = sample.uniform,
calibrated_evidence = cal.baseline.data,
calibrated_samples = cal.uniform,
timeRange = timeRange,
taphCorrect = taphCorrect,
correctForSite = correctForSite,
binSize = binSize)
source("C:/Users/Bec/Work/Projects/Radiocarbon dating/GitHub/Analysis/simulation_study-source.R")
taphCorrect = TRUE    ## whether to taphonomically correct the open sites - not currently as haven't specified whether sites are open
correctForSite = FALSE ## per bin: number of sites with at least one date in them, or number of dates within the bin total
binSize = 100          ## the size of the bins to use (years) - use a bin size that actually fits the timeRange specified
fd.uniform           <- compare_frequency_dists(evidence = baseline.data,
samples = sample.uniform,
calibrated_evidence = cal.baseline.data,
calibrated_samples = cal.uniform,
timeRange = timeRange,
taphCorrect = taphCorrect,
correctForSite = correctForSite,
binSize = binSize)
evidence
baseline.data
source("C:/Users/Bec/Work/Projects/Radiocarbon dating/GitHub/Analysis/simulation_study-source.R")
taphCorrect = TRUE    ## whether to taphonomically correct the open sites - not currently as haven't specified whether sites are open
correctForSite = FALSE ## per bin: number of sites with at least one date in them, or number of dates within the bin total
binSize = 100          ## the size of the bins to use (years) - use a bin size that actually fits the timeRange specified
fd.uniform           <- compare_frequency_dists(evidence = baseline.data,
samples = sample.uniform,
calibrated_evidence = cal.baseline.data,
calibrated_samples = cal.uniform,
timeRange = timeRange,
taphCorrect = taphCorrect,
correctForSite = correctForSite,
binSize = binSize)
taphCorrect = TRUE    ## whether to taphonomically correct the open sites - not currently as haven't specified whether sites are open
correctForSite = FALSE ## per bin: number of sites with at least one date in them, or number of dates within the bin total
binSize = 100          ## the size of the bins to use (years) - use a bin size that actually fits the timeRange specified
# Get median bin age for x axis (same for all plots)
median.bin.age   <- seq(timeRange[2] + binSize/2, timeRange[1] - binSize/2, by = binSize)
fd.uniform           <- compare_frequency_dists(evidence = baseline.data,
samples = sample.uniform,
calibrated_evidence = cal.baseline.data,
calibrated_samples = cal.uniform,
timeRange = timeRange,
taphCorrect = taphCorrect,
correctForSite = correctForSite,
binSize = binSize)
nsim=2
taphCorrect = TRUE    ## whether to taphonomically correct the open sites - not currently as haven't specified whether sites are open
correctForSite = FALSE ## per bin: number of sites with at least one date in them, or number of dates within the bin total
binSize = 100          ## the size of the bins to use (years) - use a bin size that actually fits the timeRange specified
# Get median bin age for x axis (same for all plots)
median.bin.age   <- seq(timeRange[2] + binSize/2, timeRange[1] - binSize/2, by = binSize)
fd.uniform           <- compare_frequency_dists(evidence = baseline.data,
samples = sample.uniform,
calibrated_evidence = cal.baseline.data,
calibrated_samples = cal.uniform,
timeRange = timeRange,
taphCorrect = taphCorrect,
correctForSite = correctForSite,
binSize = binSize)
fd.singleton.ancient <- compare_frequency_dists(evidence = baseline.data,
samples = sample.singleton.ancient,
calibrated_evidence = cal.baseline.data,
calibrated_samples = cal.singleton.ancient,
timeRange = timeRange,
taphCorrect = taphCorrect,
correctForSite = correctForSite,
binSize = binSize)
fd.singleton.recent  <- compare_frequency_dists(evidence = baseline.data,
samples = sample.singleton.recent,
calibrated_evidence = cal.baseline.data,
calibrated_samples = cal.singleton.recent,
timeRange = timeRange,
taphCorrect = taphCorrect,
correctForSite = correctForSite,
binSize = binSize)
fd.singleton.random  <- compare_frequency_dists(evidence = baseline.data,
samples = sample.singleton.random,
calibrated_evidence = cal.baseline.data,
calibrated_samples = cal.singleton.random,
timeRange = timeRange,
taphCorrect = taphCorrect,
correctForSite = correctForSite,
binSize = binSize)
fd.bracketed         <- compare_frequency_dists(evidence = baseline.data,
samples = sample.bracketed,
calibrated_evidence = cal.baseline.data,
calibrated_samples = cal.bracketed,
timeRange = timeRange,
taphCorrect = taphCorrect,
correctForSite = correctForSite,
binSize = binSize)
# Get median bin age for x axis (same for all plots)
median.bin.age   <- seq(timeRange[2] + binSize/2, timeRange[1] - binSize/2, by = binSize)
# Uniform
ggplot(NULL) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.uniform$standardised.envelope[[1]][,1],
ymax = fd.uniform$standardised.envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_spline(aes(x = median.bin.age, y = fd.uniform$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#66C2A5", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.uniform$standardised.baseline[,1]), lwd = 1,
colour = "black", linetype = "dashed", df = 40) +
labs(x = "Years cal BP", y = "Standardised frequency (frequency/sum(frequency) for each sample)") +
ggtitle("5 uniformly selected samples from 50% of sites") +
scale_x_reverse() +
theme_bw()
# Singleton ancient
ggplot(NULL) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.singleton.ancient$standardised.envelope[[1]][,1],
ymax = fd.singleton.ancient$standardised.envelope[[1]][,3]), fill = "#FC8D62", alpha = 0.3) +
geom_spline(aes(x = median.bin.age, y = fd.singleton.ancient$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#FC8D62", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.singleton.ancient$standardised.baseline[,1]), lwd = 1,
colour = "black", linetype = "dashed", df = 40) +
labs(x = "Years cal BP", y = "Standardised frequency (frequency/sum(frequency) for each sample)") +
ggtitle("Only the most ancient sample from 50% of sites") +
scale_x_reverse() +
theme_bw()
# Singleton recent
ggplot(NULL) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.singleton.recent$standardised.envelope[[1]][,1],
ymax = fd.singleton.recent$standardised.envelope[[1]][,3]), fill = "#8DA0CB", alpha = 0.3) +
geom_spline(aes(x = median.bin.age, y = fd.singleton.recent$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#8DA0CB", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.singleton.recent$standardised.baseline[,1]), lwd = 1,
colour = "black", linetype = "dashed", df = 40) +
labs(x = "Years cal BP", y = "Standardised frequency (frequency/sum(frequency) for each sample)") +
ggtitle("Only the most recent sample from 50% of sites") +
scale_x_reverse() +
theme_bw()
# Singleton random
ggplot(NULL) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.singleton.random$standardised.envelope[[1]][,1],
ymax = fd.singleton.random$standardised.envelope[[1]][,3]), fill = "#E78AC3", alpha = 0.3) +
geom_spline(aes(x = median.bin.age, y = fd.singleton.random$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#E78AC3", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.singleton.random$standardised.baseline[,1]), lwd = 1,
colour = "black", linetype = "dashed", df = 40) +
labs(x = "Years cal BP", y = "Standardised frequency (frequency/sum(frequency) for each sample)") +
ggtitle("One random sample from 50% of sites") +
scale_x_reverse() +
theme_bw()
# Bracketed
ggplot(NULL) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.bracketed$standardised.envelope[[1]][,1],
ymax = fd.bracketed$standardised.envelope[[1]][,3]), fill = "#A6D854", alpha = 0.3) +
geom_spline(aes(x = median.bin.age, y = fd.bracketed$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#A6D854", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.bracketed$standardised.baseline[,1]), lwd = 1,
colour = "black", linetype = "dashed", df = 40) +
labs(x = "Years cal BP", y = "Standardised frequency (frequency/sum(frequency) for each sample)") +
ggtitle("Only most ancient and most recent sample from 50% sites (bracketed)") +
scale_x_reverse() +
theme_bw()
# All
ggplot(NULL) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.uniform$standardised.envelope[[1]][,1],
ymax = fd.uniform$standardised.envelope[[1]][,3]), fill = "#66C2A5", alpha = 0.3) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.singleton.ancient$standardised.envelope[[1]][,1],
ymax = fd.singleton.ancient$standardised.envelope[[1]][,3]), fill = "#FC8D62", alpha = 0.3) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.singleton.recent$standardised.envelope[[1]][,1],
ymax = fd.singleton.recent$standardised.envelope[[1]][,3]), fill = "#8DA0CB", alpha = 0.3) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.singleton.random$standardised.envelope[[1]][,1],
ymax = fd.singleton.random$standardised.envelope[[1]][,3]), fill = "#E78AC3", alpha = 0.3) +
geom_ribbon(aes(x = median.bin.age, ymin = fd.bracketed$standardised.envelope[[1]][,1],
ymax = fd.bracketed$standardised.envelope[[1]][,3]), fill = "#A6D854", alpha = 0.3) +
geom_spline(aes(x = median.bin.age, y = fd.uniform$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#66C2A5", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.singleton.ancient$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#FC8D62", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.singleton.recent$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#8DA0CB", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.singleton.random$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#E78AC3", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.bracketed$standardised.envelope[[1]][,2]), lwd = 1,
colour = "#A6D854", df = 40) +
geom_spline(aes(x = median.bin.age, y = fd.bracketed$standardised.baseline[,1]), lwd = 1,
colour = "black", linetype = "dashed", df = 40) +
labs(x = "Years cal BP", y = "Standardised frequency (frequency/sum(frequency) for each sample)") +
ggtitle("All sampling methods on same plot") +
scale_x_reverse() +
theme_bw()
